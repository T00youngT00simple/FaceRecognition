## 基于树莓派的智能人脸识别考勤系统研究
### 1.具体设计
#### 1.1 总体设计
 后端选择采用python语言开发，在后端树莓派上需要完成人脸信息的录入以及完成人脸签到。在后端上就涉及到几个关键问题，在录入以及签到的过程中如何建立视频流获取录入学生的人脸，如何识别视频流中的人脸生物特征，对识别后的人脸生物特征如何进行存储，如何进行识别，识别后该以怎样的方式进行存储。在前端上主要涉及到数据库的设计。后端人脸特征签到应该入库怎样的信息，前端显示怎样的数据库信息以及完成对所显示表的增删改查。  
 同时作为一款签到管理系统应该具备请假功能，而请假功能的实现需要建立怎样的数据库，请假功能的审批还意味着需要将前端的学生登录以及管理员权限分离，在后端建立新的人脸信息时需要同时创建学生信息表，对于人脸特征识别图片又该怎样存储。
### 2.详细设计
#### 2.1人脸信息采集及识别
 藉由wxpython依次弹出两个gettext对话框与用户交互获得用户输入的用户名称以及用户ID，而在用户输入时需要作出查重操作。透过opencv建立视频流，这里就涉及一个问题，按照常规的opencv建立视频流的方法获得一个摄像头对象，在一个死循环中截取图像并对图像按照需求做一系列如翻转，灰度变换等操作。最后透过imwait以及imshow函数显示一个视频流对象窗口。而在本程序的设计人脸录入以及刷脸签到这两个需要建立视频流的功能键都建立了新的UI窗口来细化了功能分类。我们应将视频显示限制的在这两项功能所创建的子窗口中，该需求的设计思想为将循环中每一张截取图像通过wxpython的Bitmap显示在子窗口中，即在ui上刷新显示while循环中截取图像的方法获得类视频流。  


 树莓派本地的特征记录抽取用户数据训练opencv识别器，训练的基本流程为对每张图像进行灰度处理，图像中的人脸特征处理。用户键入的ID与人脸特征作为训练识别器的唯二参数。若在训练流程中未能检测出人脸特征则依然需删除该条记录所保存的10张图片，并一提示框提示，在新的录入过程中输入姓名与ID的重复检测是基于本地已保存图片的命名。识别器将会被录入过程以及签到过程使用用以检测是否重复录入以及识别人脸完成签到。
#### 2.2用户签到及数据保存
 在人脸特征识别调用级联器检测人脸使用录入时所训练的识别器进行人脸识别确定录入人员的签到时间以及签到日期存入表CHECK_LOG中，按照定义的签到规则判断签到状态旷课、迟到、签到等一系列状态以int类型与用户姓名及ID相关联存入user中，确定签到人员状态后更新user表中对应人员签到统计。规定可签到时间为课前半小时及课后20分钟，其余状态下不可签到，上课时间的规定为单独一张表由管理员在前端页面设置。在课后不可签到状态下检索CHECK_LOG表当前日期为签到人员以及未请假人员更新旷课次数加一。
#### 2.3前端页面设计
 本系统通过数据库将前后端进行连接，在前端设计中总共包含11个页面，主要的登陆页面分离为普通用户与管理员。二者跳转的页面与权限不相同，普通用户的登陆通过检索user表，账号为用户在后端键入的用户名，密码为用户键入的用户ID，其包含的权限主要为查询签到统计表user，检索包含用户名称对应的迟到、签到、旷课此时，不包含每个用户所包含的ID，检索签到日志表CHECK_LOG，请假功能，请假状态查询。管理员的登陆通过检索单独的admin表，其包含同样为检索user以及CHEC-K_LOG表，普通用户的请假审批以及设置上下课时间使得后端可按照签到规则以及上下课时间确定签到状态以更新user在前端页面显示签到统计。
